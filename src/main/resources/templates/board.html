<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head th:replace="header :: header_h">
  <meta charset="UTF-8">
  <title>Login</title>
</head>
<body>
<div th:replace="header :: header"></div>

<div class="container">

  <h1 class="text-center">Bulletin Board!</h1>
  <br>
  <hr>

  <table class="table table-hover table-striped" style="text-align:center;">

    <tr>
      <th>번호</th>
      <th>제목</th>
      <th>작성자</th>
      <th>작성일</th>
      <th>조회수</th>
    </tr>

    <tr th:each="boardDtos : ${boardDtos}">

      <td th:text="${boardDtos.id}"></td>

      <td th:if="${boardDtos.rcount == 0}"> <!-- 댓글이 없는경우  Title만 출력 -->
        <a th:href="@{/boardview(no=${boardDtos.no}, id=${boardDtos.id},count=${boardDtos.count})}">
          <span th:text="${boardDtos.title}"></span>
        </a>
      </td>

      <td th:if="${boardDtos.rcount != 0}"> <!-- 댓글이 하나 이상일 경우 Title[댓글개수] 출력 -->
        <a th:href="@{/boardview(no=${boardDtos.no}, id=${boardDtos.id},count=${boardDtos.count})}">
          <span th:text="|${boardDtos.title}[&nbsp;${boardDtos.rcount}&nbsp;]|"></span>
        </a>
      </td>

      <td th:text="${boardDtos.name}"></td>

      <td th:text="${#temporals.format(boardDtos.createDate, 'yy-MM-dd')}"></td>

      <td th:text="${boardDtos.count}"></td>

    </tr>

  </table>
  <hr>
  <a th:if="${session.loginuser != null}" th:href="@{/boardwrite}" class="btn btn-light" style="border-radius: 15px; padding: 7px 13px; float: right;">등록</a>
  <div th:if="${session.loginuser == null}" style="text-align:center; color:red; margin-bottom:10px;">로그인 후 등록 가능합니다.</div>

  <!-- 페이징 처리 -->
  <!--<div id="pag" style="text-align:center;">
    &lt;!&ndash;시작페이지 , 끝페이지 설정&ndash;&gt;
      &lt;!&ndash; 타임리프 변수 정의 : th:with= &ndash;&gt;
        &lt;!&ndash; 첫페이지번호 :  ( 현재페이지/10 ) * 10 + 1 &ndash;&gt;
          &lt;!&ndash; 0/10  * 10 + 1 -> 1 &ndash;&gt;
          &lt;!&ndash; 13/10 * 10 + 1 => 11 &ndash;&gt;

    <ul class="pagination justify-content-center"
        th:with="start=${T(Math).floor(boardDtos.number/10) * 10 + 1},
          last=(${start + 9 < boardDtos.totalPages ? start + 9 : boardDtos.totalPages})">

      &lt;!&ndash; 첫페이지이동 &ndash;&gt;
      <li class="page-item">
        <a class="page-link" th:href="@{/board(page=1)}"> << </a>
      </li>

      &lt;!&ndash; 이전페이지이동 &ndash;&gt;
      <li class="page-item" th:class="${boardDtos.first} ? 'disabled'"> &lt;!&ndash; 첫번페이지에서 이전페이지이동 표시 x &ndash;&gt;
        <a class="page-link" th:href="${boardDtos.first} ? '#' : @{/board(page = ${boardDtos.number})}"> < </a>
      </li>

      &lt;!&ndash; 페이지번호 &ndash;&gt;
      <li class="page-item" th:each="page : ${#numbers.sequence(start, last)}">
        <a class="page-link" th:href="@{/board(page = ${page})}" th:text="${page}"></a>
      </li>

      &lt;!&ndash; 다음페이지이동 &ndash;&gt;
      <li class="page-item" th:class="${boardDtos.last} ? 'disabled'"> &lt;!&ndash; 첫번째 페이지에서 다음페이지 이동 표시 x &ndash;&gt;
        <a class="page-link" th:href="${boardDtos.last} ? '#' : @{/board(page = ${boardDtos.number + 2})}"> > </a>
      </li>

      &lt;!&ndash; 마지막페이지 이동 &ndash;&gt;
      <li class="page-item">
        <a class="page-link" th:href="@{/board(page = ${boardDtos.totalPages})}"> >> </a>
      </li>

    </ul>

  </div>-->

  <div class="text-center">
    <span><a th:href="@{/board(currentPage=1)}">처음</a></span>

    <!-- 현재 페이지가 1보다 클 경우 이전 href, 1보다 작은 경우 이전 text -->
    <span th:if="${currentPage > 1}"><a th:href="@{/board(currentPage=(${currentPage}-1))}">이전</a></span>
    <span th:unless="${currentPage > 1}" th:text="이전"></span>

    <!-- #number.sequence 인수로 지정한 2개의 수 범위에서 배열을 생성 -->
    <th:block th:each="num : ${#numbers.sequence(startPageNum,lastPageNum)}">
      <span th:if="${currentPage == num}" th:text="${'['+ num + ']'}"></span>
      <a th:unless="${currentPage == num}" th:text="${'['+ num + ']'}" th:href="@{/board(currentPage=${num})}"></a>
    </th:block>

    <!-- 현재 페이지가 마지막페이지와 같지 않을 경우 다음 href, 같을 경우 다음 text -->
    <span th:if="${currentPage != lastPage}"><a th:href="@{/board(currentPage=(${currentPage}+1))}">다음</a></span>
    <span th:unless="${currentPage != lastPage}" th:text="다음"></span>
    <span><a th:href="@{/board(currentPage=${lastPage})}">마지막</a></span>
  </div>


  <div class="row-fluid" style="text-align:center;">
  <form method="post" action="/boardsearch">

    <select class="form-select" name="keyword" style="width:100px; display:inline-block;">
      <option value="id">번호</option>
      <option value="title">제목</option>
      <option value="contents">내용</option>
      <option value="name">작성자</option>
    </select>

    <input type="text" class="form-control" name="search" placeholder="Search" style="width: 25%; display:inline-block;">
    <button type="submit" class="btn btn-default" style="padding: 0 0 5px 5px;">Search</button>

  </form>
  </div>

</div>

<br><br><br>

<div th:replace="footer :: footer"></div>
</body>
</html>